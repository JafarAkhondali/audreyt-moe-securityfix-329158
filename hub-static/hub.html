<!doctype html>
<!--[if lt IE 7]> <html lang="zh-tw" class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html lang="zh-tw" class="lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html lang="zh-tw" class="lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="zh-tw"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Hub</title>
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" media="screen" href="../stylesheets/hub.css">
</head>
<body>
    <div class="twinkling"></div>
    <div class="content-wrapper">
        <div class="main-control">
            <a href="#" class="gogo">gogo</a>
            <a href="#" class="main-btn">主選單</a>
            <div class="tube project-users">
                <a href="#" class="tube-status open"><i class="icon-circle-blank"></i></a>
                <span class="moving-word output">草木</span>
            </div>
            <div class="tube project-tmuse"><a href="#" class="tube-status open"><i class="icon-circle-blank"></i></a></div>
            <div class="tube project-tmuse"><a href="#" class="tube-status open"><i class="icon-circle-blank"></i></a></div>
            <div class="tube project-dict"><a href="#" class="tube-status open"><i class="icon-circle-blank"></i></a></div>
            <div class="tube project-ball"><a href="#" class="tube-status open"><i class="icon-circle-blank"></i></a></div>
            <div class="tube project-thc"><a href="#" class="tube-status open"><i class="icon-circle-blank"></i></a></div>
            <div class="tube project-map"><a href="#" class="tube-status open"><i class="icon-circle-blank"></i></a></div>
        </div>
        <div class="iframe-wrapper v-type project-users">
            <div class="iframe-header">
                <div class="controls">
                    <a href="#" class="zoom"><i class="icon-zoom-in"></i></a>
                </div>
                <div class="input">
                    <input type="text" class="input-words" />
                    <button>Push</button>
                </div>
            </div>
            <div class="iframe">
                <iframe src="https://www.moedict.tw/#萌"></iframe>
            </div>
        </div>
        <div class="iframe-wrapper w-type project-tmuse">
            <div class="iframe-header">
                <div class="controls">
                    <a href="#" class="zoom"><i class="icon-zoom-in"></i></a>
                </div>
                <div class="input">
                    <input type="text" class="input-words" />
                    <button>Push</button>
                </div>
            </div>
            <div class="iframe">
                <iframe src="https://www.moedict.tw/#萌"></iframe>
            </div>
        </div>
        <div class="iframe-wrapper v-type project-dict">
            <div class="iframe-header">
                <div class="controls">
                    <a href="#" class="zoom"><i class="icon-zoom-in"></i></a>
                </div>
                <div class="input">
                    <input type="text" class="input-words" />
                    <button>Push</button>
                </div>
            </div>
            <div class="iframe">
                <iframe src="https://www.moedict.tw/#萌"></iframe>
            </div>
        </div>
        <div class="iframe-wrapper n-type project-ball">
            <div class="iframe-header">
                <div class="controls">
                    <a href="#" class="zoom"><i class="icon-zoom-in"></i></a>
                </div>
                <div class="input">
                    <input type="text" class="input-words" />
                    <button>Push</button>
                </div>
            </div>
            <div class="iframe">
                <iframe src="https://www.moedict.tw/#萌"></iframe>
            </div>
        </div>
        <div class="iframe-wrapper w-type project-thc">
            <div class="iframe-header">
                <div class="controls">
                    <a href="#" class="zoom"><i class="icon-zoom-in"></i></a>
                </div>
                <div class="input">
                    <input type="text" class="input-words" />
                    <button>Push</button>
                </div>
            </div>
            <div class="iframe">
                <iframe src="https://www.moedict.tw/#萌"></iframe>
            </div>
        </div>
        <div class="iframe-wrapper n-type project-map">
            <div class="iframe-header">
                <div class="controls">
                    <a href="#" class="zoom"><i class="icon-zoom-in"></i></a>
                </div>
                <div class="input">
                    <input type="text" class="input-words" />
                    <button>Push</button>
                </div>
            </div>
            <div class="iframe">
                <iframe src="https://www.moedict.tw/#萌"></iframe>
            </div>
        </div>
    </div>
    <div class="lightbox">
        <a href="#" class="lightbox-close"><i class="icon-remove"></i></a>
        <div class="big-iframe">
            <iframe src="https://www.moedict.tw/#萌"></iframe>
        </div>
        <div class="nav">
            <ul>
                <li><a href="#">匯出記錄</a></li>
                <li><a href="#">關於</a></li>
                <li class="share">
                    告訴朋友：
                    <a href="#"><i class="icon-facebook-sign"></i></a>
                    <a href="#"><i class="icon-google-plus-sign"></i></a>
                    <a href="#"><i class="icon-twitter-sign"></i></a>
                </li>
            </ul>
        </div>
    </div>

<script src="javascripts/jquery-1.10.2.min.js"></script>
<script>
$(function(){
    //lightbox
    $(".lightbox").hide();
    $(".main-btn").on("click", function() {
        $(".lightbox").fadeIn();
    });
    $(".lightbox .lightbox-close").on("click", function() {
        $(".lightbox").fadeOut();
    });

    // get window width & height
    var windowWidth = $(window).width();
    var windowHeight = $(window).height();

    // set content-wrapper height
    var contentWidth, contentHeight;
    if (windowHeight/windowWidth <= 9/16) {
        contentWidth = windowHeight / 9 * 16;
        contentHeight = windowHeight;
    }
    else {
        contentWidth = windowWidth;
        contentHeight = windowWidth / 4 * 3;
    }
    $(".content-wrapper").css({width: contentWidth, height: contentHeight, "background-size": '"'+contentWidth*0.8+'px '+contentWidth*0.48+'px"'});

    // calculate main-control position
    $(".main-control .main-btn").css({"z-index": 10, top: contentHeight*0.5 - 42, left: contentWidth*0.5-42});

    // calculate block size
    var nBlockWidth, nBlockHeight, wBlockWidth, vBlockHeight;
    nBlockWidth = contentWidth * 0.28;
    nBlockHeight = contentHeight * 0.32;
    wBlockWidth = contentWidth* 0.34;
    vBlockHeight = contentHeight * 0.4;

    $(".iframe-wrapper.n-type").css({width: nBlockWidth, height: nBlockHeight});
    $(".iframe-wrapper.w-type").css({width: wBlockWidth, height: nBlockHeight});
    $(".iframe-wrapper.v-type").css({width: nBlockWidth, height: vBlockHeight});
    $(".iframe-wrapper .iframe").css({width: nBlockWidth-16, height: nBlockHeight-46});
    $(".iframe-wrapper.v-type .iframe").css({height: vBlockHeight-46});
    $(".iframe-wrapper.w-type .iframe").css({width: wBlockWidth-16});

    // calculate block position. project-users, project-tmuse, project-dict, project-ball, project-thc, project-map
    $(".iframe-wrapper.project-tmuse").css({top: contentHeight*0.01});
    $(".iframe-wrapper.v-type").css({top:contentHeight*0.1});
    $(".iframe-wrapper.project-ball, .iframe-wrapper.project-map").css({top:contentHeight*0.52});
    $(".iframe-wrapper.project-thc").css({top: contentHeight*0.99-nBlockHeight});
    $(".iframe-wrapper.w-type").css({left:(contentWidth-wBlockWidth)/2});
    $(".iframe-wrapper.project-users, .iframe-wrapper.project-ball").css({left:"2%"});
    $(".iframe-wrapper.project-dict, .iframe-wrapper.project-map").css({left:contentWidth*0.98-nBlockWidth});

    // tube-status position 
    var centerPointX = contentWidth/2;
    var centerPointY = contentHeight/2;
    $(".tube.project-users .tube-status, .tube.project-dict .tube-status").css({top: centerPointY-41});
    $(".tube.project-ball .tube-status, .tube.project-map .tube-status").css({top: centerPointY+6});
    $(".tube.project-users .tube-status, .tube.project-ball .tube-status").css({left: centerPointX-94});
    $(".tube.project-dict .tube-status, .tube.project-map .tube-status").css({left: centerPointX+58});
    $(".tube.project-tmuse .tube-status, .tube.project-thc .tube-status").css({left: centerPointX-18});
    $(".tube.project-tmuse .tube-status").css({top: centerPointY-96});
    $(".tube.project-thc .tube-status").css({top: centerPointY+60});

    // tube-status toggle
    $(".tube-status").on("click", function() {
        $(this).toggleClass("open").toggleClass("close");
        $(this).find("i").toggleClass("icon-circle-blank").toggleClass("icon-ban-circle");
    });

    // input / output words
    // 僅供樣式測試，功能不正確
    var pUserWordPosition = {top: contentHeight*0.3, left: contentWidth*0.02+nBlockWidth/2};
    var pMapWordPosition = {top: contentHeight*0.52+nBlockHeight/2, left: contentWidth*0.98-nBlockWidth/2};


    $(".tube.project-users .moving-word").css(pUserWordPosition);
    $(".gogo").on("click", function(e) {
        e.preventDefault();
        var currentWordWidth = $(".tube.project-users .moving-word").width();
        var currentWordHeight = $(".tube.project-users .moving-word").height();
        var centerPosition = { top: (contentHeight - currentWordHeight)/2, left: (contentWidth - currentWordWidth)/2};
        $(".tube.project-users .moving-word").animate(centerPosition,{
            duration: 2500,
            complete: function() {
                $(".tube.project-users .moving-word").animate(pMapWordPosition, 2500);
            }
        });
    });


    // zoom in & zoom out
    var originWidth, originHeight, originTop, originLeft;
    $("a.zoom").on("click", function(e) {
        e.preventDefault();
        var thisBlock = $(this).parents(".iframe-wrapper");
        var thisIframe = $(this).parents(".iframe-wrapper").find(".iframe");
        if ($(this).find("i").hasClass("icon-zoom-in")) {
            originWidth = thisBlock.width();
            originHeight = thisBlock.height();
            originTop = thisBlock.css("top");
            originLeft = thisBlock.css("left");
            thisBlock.css({"z-index": 9999, position: "fixed"}).animate({width: windowWidth*0.98, height: windowHeight*0.98, top: "1%", left: "1%"});
            thisIframe.animate({width: windowWidth*0.98-16, height: windowHeight*0.98-46});
            $(this).find("i").removeClass("icon-zoom-in").addClass("icon-zoom-out");
        }
        else {
            thisBlock.animate({width: originWidth, height: originHeight, top: originTop, left: originLeft});
            thisIframe.animate({width: originWidth-16, height: originHeight-46}, {
                complete: function() {
                    thisBlock.css({"z-index": 5, position: "absolute"});
                }
            });
            
            $(this).find("i").removeClass("icon-zoom-out").addClass("icon-zoom-in");
        }
    });
    
});
</script>
</body>
</html>
