// Generated by LiveScript 1.2.0
(function(){
  var origin, buffer, myInput, myOutput, CharComp, CompChar, msgBeforeData, msgAfterData;
  Array.prototype.powerset = function(){
    var xs, x, p;
    if (this.length === 1) {
      return this;
    }
    xs = this.slice();
    x = xs.pop();
    p = xs.powerset();
    return p.concat(p.map(function(it){
      return it.concat([x]);
    }));
  };
  origin = "http://127.0.0.1:8888/";
  buffer = [];
  myInput = "";
  myOutput = [];
  buffer = [];
  msgBeforeData = function(arg$){
    var data;
    data = arg$.data;
    return buffer.push(data);
  };
  msgAfterData = function(arg$){
    var data, comps, i$, len$, char, j$, ref$, len1$, c, maybe;
    data = arg$.data;
    myInput = data;
    myOutput = [];
    comps = [];
    for (i$ = 0, len$ = myInput.length; i$ < len$; ++i$) {
      char = myInput[i$];
      if (!CharComp[char]) {
        continue;
      }
      for (j$ = 0, len1$ = (ref$ = CharComp[char]).length; j$ < len1$; ++j$) {
        c = ref$[j$].c;
        comps.push(c);
      }
    }
    for (i$ = 0, len$ = (ref$ = comps.powerset()).length; i$ < len$; ++i$) {
      maybe = ref$[i$];
      if (CompChar[maybe]) {
        myOutput.push(CompChar[maybe]);
      }
    }
    window.output(myOutput);
    return myOutput;
  };
  window.id = 'lhc';
  window.reset = function(){
    return myInput = "";
  };
  window.input = function(it){
    return msgBeforeData({
      data: it
    });
  };
  window.addEventListener('message', msgBeforeData);
  window.output = function(it){
    if (window.muted) {
      return;
    }
    return window.top.postMessage(it, origin);
  };
  $.get('./data/char_comp.json', function(d){
    CharComp = d;
    return $.get('./data/comp_char.json', function(d){
      var i$, ref$, len$, data;
      CompChar = d;
      window.input = function(it){
        return msgAfterData({
          data: it
        });
      };
      window.removeEventListener('message', msgBeforeData);
      for (i$ = 0, len$ = (ref$ = buffer).length; i$ < len$; ++i$) {
        data = ref$[i$];
        msgAfterData({
          data: data
        });
      }
      return window.addEventListener('message', msgAfterData);
    });
  });
}).call(this);
